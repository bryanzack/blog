---
layout: post
title: "Red This"
date: 2025-05-18
---



### About

This challenge involves taking advantage of a poorly structured Redis NoSQL database to retrieve an administrators password and impersonate them to retrieve the flag from a protected endpoint.

### Intended use
The website lets you select a famous person to receive a quote from.
![[vmware_SUdj5nm404.png]]




Intercepting the request, we can see that it sends a POST request with the `famous_person` payload being set to the person we want the quote from. Change the `famous_person` key, get its corresponding value from the Redis database.
![[vmware_S9iS0gHqfC.png]]


### The "Database"
The `insert.redis`  population script is shown below. Right away we can observe sensitive data being stored alongside the quotes.

```
set key value
set "FDR" "The only thing we have to fear is fear itself."
set "Shakespeare" "To be, or not to be, that is the question."
set "Mandela" "The greatest glory in living lies not in never falling, but in rising every time we fall."
set "Theodore Roosevelt" "Believe you can and you're halfway there."
set "Disney" "All our dreams can come true, if we have the courage to pursue them."

set "admin" "User"
set "admin_password" "prod_has_a_different_password"
set "fake_flag" "I told you"
set "flag_" "byuctf{test_flag}"
JSON.SET admin_options $ '["hints", "fake_flag", "flag_"]'
```


By changing the `famous_person` POST payload to be `admin_password`, we are given the administrators password to be used in the `/login` page.
![[vmware_WhGBo3ZTnu.png]]
![[vmware_HjB7pxHE2w.png]]

### Flag
After logging in as an admin, we are now able to see options only viewable by the admin, including the flag.


![[vmware_N5cFKXiOGG.png]]![[vmware_i2m8PGb7qX.png]]